<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Go Build | Carson Blog</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="ldflags 輸入 go tool link 可以查到ldflags的訊息(例如-s, -w) 我建議如果要打包執行檔出去，用這個指令 go build -ldflags &#34;-H=windowsgui"><meta name=generator content="Hugo 0.81.0"><meta name=ROBOTS content="INDEX, FOLLOW"><link href=/css/markmap.css rel=stylesheet><script src=https://d3js.org/d3.v6.min.js></script><script src=/js/uml/markmap-view@0.2.0.js></script><script defer src=/js/uml/markmap.js></script><link href=/dist/css/search-fuse.css rel=stylesheet><link rel=stylesheet type=text/css href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css integrity="sha512-HK5fgLBL+xu6dm/Ii3z4xhlSUyZgTT9tuc/hSrtw6uzJOvgRr2a9jyxxT1ely+B+xFAmJKVSTbpM/CuL7qxO8w==" crossorigin=anonymous><script defer src=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/js/all.min.js integrity="sha512-UwcC/iaz5ziHX7V6LjSKaXgCuRRqbTp1QHpbOJ4l1nw2/boCfZ2KlFIqBUA/uRVF0onbREnY9do8rM/uT/ilqw==" crossorigin=anonymous></script><link rel=stylesheet href=/css/google-fonts.css><link rel=stylesheet href=/css/embed-bk-img.css><link href=/dist/css/app.4fc0b62e4b82c997bb0041217cd6b979.css rel=stylesheet><link href=/dist/css/navbar.css rel=stylesheet><link href=/dist/css/card_post.css rel=stylesheet><link href=/dist/css/utils.css rel=stylesheet><link href=/dist/sass/main_sass.css rel=stylesheet><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css rel=stylesheet integrity=sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1 crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js integrity=sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW crossorigin=anonymous></script><link rel="shortcut icon" href=/images/tab_icon.jpg type=image/x-icon><meta property="og:title" content="Go Build"><meta property="og:description" content="ldflags 輸入 go tool link 可以查到ldflags的訊息(例如-s, -w) 我建議如果要打包執行檔出去，用這個指令 go build -ldflags &#34;-H=windowsgui"><meta property="og:type" content="article"><meta property="og:url" content="https://carsonslovoka.github.io/pg_lang/golang/exe/go-build-exe/"><meta property="article:section" content="pg_lang"><meta property="article:published_time" content="2021-03-18T14:49:03+08:00"><meta property="article:modified_time" content="2021-03-18T00:00:00+08:00"><meta itemprop=name content="Go Build"><meta itemprop=description content="ldflags 輸入 go tool link 可以查到ldflags的訊息(例如-s, -w) 我建議如果要打包執行檔出去，用這個指令 go build -ldflags &#34;-H=windowsgui"><meta itemprop=datePublished content="2021-03-18T14:49:03+08:00"><meta itemprop=dateModified content="2021-03-18T00:00:00+08:00"><meta itemprop=wordCount content="1784"><meta itemprop=keywords content="exe,go,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Go Build"><meta name=twitter:description content="ldflags 輸入 go tool link 可以查到ldflags的訊息(例如-s, -w) 我建議如果要打包執行檔出去，用這個指令 go build -ldflags &#34;-H=windowsgui"><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-98900980-4','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body data-bs-spy=scroll data-bs-target=#navbar class="ma0 bg-near-white google-noto-sans-tc"><header><div class=bg-black><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib"><i class="zoom-in fas fa-home fa-3x" style=color:#ffc34d></i></a><div class="flex-l items-center"><ul class="pl0 mr3"><li class="zoom-in list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/site-search/ title><i class="fas fa-search"></i></a></li><li class="zoom-in list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/pages-timeline/ title><i class="fas fa-code-branch"></i></a></li><li class="zoom-in list f5 f4-ns fw4 dib pr3"><i class="fas fa-sitemap" style=color:#b1e844></i><a class="hover-white no-underline white-90" href=/site-markmap/ title=地圖>地圖</a></li><li class="zoom-in list f5 f4-ns fw4 dib pr3"><i class="fas fa-h-square" style=color:#e844a8></i><a class="hover-white no-underline white-90" href=/hugo/ title=教學>教學</a></li></ul></div></div></nav></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked">GOLANG-EXE</aside><div id=sharing class=mt3><a href="https://www.facebook.com/sharer.php?u=https://carsonslovoka.github.io/pg_lang/golang/exe/go-build-exe/" class="facebook no-underline" aria-label="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></a><a href="https://twitter.com/share?url=https://carsonslovoka.github.io/pg_lang/golang/exe/go-build-exe/&text=Go%20Build" class="twitter no-underline" aria-label="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a><a href="https://www.linkedin.com/shareArticle?mini=true&url=https://carsonslovoka.github.io/pg_lang/golang/exe/go-build-exe/&title=Go%20Build" class="linkedin no-underline" aria-label="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a></div><h1 class="f1 athelas mt3 mb1">Go Build</h1><time class="f6 mv4 dib tracked" datetime=2021-03-18T14:49:03+08:00>March 18, 2021</time></header><div class="nested-copy-line-height lh-copy google-noto-sans-tc f4 nested-links nested-img mid-gray
w-80-l"><h2 id=ldflags>ldflags</h2><p>輸入</p><blockquote><p><a href=https://stackoverflow.com/a/47967258/9935654>go tool link</a></p></blockquote><p>可以查到ldflags的訊息(例如<code>-s</code>, <code>-w</code>)</p><p>我建議如果要打包執行檔出去，用這個指令</p><blockquote><p><code>go build -ldflags "-H=windowsgui -s -w"</code></p></blockquote><h3 id=不顯示console視窗的方法>不顯示console視窗的方法</h3><p>利用選項: <code>-ldflags "-H=windowsgui"</code></p><blockquote><p><code>go build -ldflags "-H=windowsgui"</code></p></blockquote><h3 id=更小的執行檔>更小的執行檔</h3><ul><li><code>-s</code> 去掉符號信息，</li><li><code>-w</code> 去掉DWARF調試信息，得到的程序就不能用gdb調試了</li></ul><blockquote><p><code>go build -ldflags "-s -w"</code></p></blockquote><h2 id=如何為您的程式加上詳細內容>如何為您的程式加上詳細內容</h2><p>這邊一共會教您兩樣東西</p><ol><li><p><a href=https://docs.microsoft.com/en-us/windows/win32/sbscs/application-manifests>manifest</a> : 可以幫助您設定icon</p></li><li><p><a href=https://docs.microsoft.com/en-us/windows/win32/menurc/versioninfo-resource>VersionInfo</a> : 可以設定詳細資訊</p><p>主要是依靠 <a href=http://www.angusj.com/resourcehacker/>ResourceHacker</a> 其實透過他也能設定icon</p></li></ol><p>如果您只要擺上icon，不想要詳細資訊只要參考 <a href=https://docs.microsoft.com/en-us/windows/win32/sbscs/application-manifests>manifest</a> 即可。</p><h3 id=manifest><a href=https://docs.microsoft.com/en-us/windows/win32/sbscs/application-manifests>manifest</a></h3><h4 id=part-1-建立manifest檔案>Part 1: 建立manifest檔案</h4><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; standalone=&#34;yes&#34;?&gt;</span>
<span style=color:#f92672>&lt;assembly</span> <span style=color:#a6e22e>xmlns=</span><span style=color:#e6db74>&#34;urn:schemas-microsoft-com:asm.v1&#34;</span> <span style=color:#a6e22e>manifestVersion=</span><span style=color:#e6db74>&#34;1.0&#34;</span><span style=color:#f92672>&gt;</span>
    <span style=color:#f92672>&lt;assemblyIdentity</span>
        <span style=color:#a6e22e>version=</span><span style=color:#e6db74>&#34;0.0.0.0&#34;</span>
        <span style=color:#a6e22e>processorArchitecture=</span><span style=color:#e6db74>&#34;*&#34;</span>
        <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;SOME FUNKY NAME HERE&#34;</span>
        <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;win32&#34;</span>
    <span style=color:#f92672>/&gt;</span>  <span style=color:#75715e>&lt;!-- processorArchitecture: x64, x86 --&gt;</span>
    <span style=color:#f92672>&lt;dependency&gt;</span>
        <span style=color:#f92672>&lt;dependentAssembly&gt;</span>
            <span style=color:#f92672>&lt;assemblyIdentity</span>
                <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;win32&#34;</span>
                <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;Microsoft.Windows.Common-Controls&#34;</span>
                <span style=color:#a6e22e>version=</span><span style=color:#e6db74>&#34;6.0.0.0&#34;</span>
                <span style=color:#a6e22e>processorArchitecture=</span><span style=color:#e6db74>&#34;*&#34;</span>
                <span style=color:#a6e22e>publicKeyToken=</span><span style=color:#e6db74>&#34;6595b64144ccf1df&#34;</span>
                <span style=color:#a6e22e>language=</span><span style=color:#e6db74>&#34;*&#34;</span>
            <span style=color:#f92672>/&gt;</span> <span style=color:#75715e>&lt;!-- processorArchitecture: amd64, x86, ia64 --&gt;</span>
        <span style=color:#f92672>&lt;/dependentAssembly&gt;</span>
    <span style=color:#f92672>&lt;/dependency&gt;</span>
<span style=color:#f92672>&lt;/assembly&gt;</span>
</code></pre></div><h4 id=part-2-安裝rsrc>Part 2: 安裝rsrc</h4><blockquote><p><code>go install github.com/akavel/rsrc@latest</code></p></blockquote><p>(我的版本: <code>github.com/akavel/rsrc v0.10.2</code>)</p><p>完成之後會看到: rsrc.exe</p><blockquote><p><code>%gopath%/bin/rsrc.exe</code></p></blockquote><h4 id=part-3-準備icon-可選>Part 3: 準備icon (可選)</h4><p>您可以上 <a href=https://fontawesome.com>fontawesome</a> 搜尋SVG</p><p>引入他的CSS，然後修改為顏色例如</p><blockquote><p><code>"&lt;i class='fab fa-slideshare' style='color: #f783ac'>&lt;/i>"</code></p></blockquote><p>之後把SVG轉PNG再用PNG轉ICO即可</p><h4 id=part-4-利用-rsrcexe-產生-syso檔案>Part 4: 利用 rsrc.exe 產生 syso檔案</h4><p>建立一個 字尾為 <code>.manifest</code> 的檔案, 本示例使用 <code>app.manifest</code></p><p>輸出要是 字尾為 <code>.syso</code> 的檔案</p><p>ico可以不給，看您</p><blockquote><p>rsrc -manifest app.manifest -o app.syso -ico app.ico</p></blockquote><p>syso-build.bat</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bat data-lang=bat>@<span style=color:#66d9ef>echo</span> off
rsrc.exe -manifest app.manifest -o app.syso -ico app.ico
<span style=color:#66d9ef>pause</span> &gt; nul
</code></pre></div><p>輸出是一個<code>syso</code>的檔案</p><h4 id=part-5-go-build>Part 5: go build</h4><p>將syso檔案放到和您的<code>主程式.go</code>同資料夾的位置，執行go build就可以了</p><h3 id=versioninfo><a href=https://docs.microsoft.com/en-us/windows/win32/menurc/versioninfo-resource>VersionInfo</a></h3><h4 id=簡介>簡介</h4><p>以下是您可能會常看到的 <code>Version.txt</code> 的內容</p><pre><code># UTF-8
#
# For more details about fixed file info 'ffi' see:
# http://msdn.microsoft.com/en-us/library/ms646997.aspx
VSVersionInfo(
    ffi=FixedFileInfo(
        # filevers and prodvers should be always a tuple with four items: (1, 2, 3, 4)
        # Set not needed items to zero 0.
        filevers=(0, 0, 0, 20210319),
        prodvers=(0, 0, 0, 20210319),
        # Contains a bitmask that specifies the valid bits 'flags'r
        mask=0x3f,
        # Contains a bitmask that specifies the Boolean attributes of the file.
        flags=0x0,
        # The operating system for which this file was designed.
        # 0x4 - NT and there is no need to change it.
        OS=0x4,
        # The general type of file.
        # 0x1 - the file is an application.
        fileType=0x1,
        # The function of the file.
        # 0x0 - the function is not defined for this fileType
        subtype=0x0,
        # Creation date and time stamp.
        date=(0, 0)
    ),
    kids=[
        StringFileInfo(
            [
                StringTable(
                    u'040904B0',
                    [StringStruct(u'CompanyName', u'xxx Taiwan Inc'),
                     StringStruct(u'FileDescription', u''),
                     StringStruct(u'FileVersion', u'0.0.0.0'),
                     StringStruct(u'InternalName', u''),
                     StringStruct(u'LegalCopyright', u'Copyright xxx Taiwan Inc'),
                     StringStruct(u'OriginalFilename', u''),
                     StringStruct(u'ProductName', u''),
                     StringStruct(u'ProductVersion', u'0.0.0.0 (Carson)')])
            ]),
        # https://docs.microsoft.com/zh-tw/windows/desktop/menurc/varfileinfo-block
        # 1033=美國 1200=unicode
        VarFileInfo([VarStruct(u'Translation', [1033, 1200])])
    ]
)
</code></pre><p>我把一些參考連結取出</p><ul><li><a href=http://msdn.microsoft.com/en-us/library/ms646997.aspx>VSVersionInfo中的欄位定義</a></li><li><a href=https://docs.microsoft.com/zh-tw/windows/desktop/menurc/varfileinfo-block>VarFileInfo-語言代碼查詢</a><ul><li>LangID<ul><li>0x0404: Traditional Chinese</li><li>0x0409: U.S. English</li><li>0x0411: Japanese</li></ul></li><li>charsetID<ul><li>1200: unicode</li><li>950: Taiwan (Big5)</li><li>932: Japan (Shift – JIS X-0208)</li></ul></li></ul></li></ul><p>以上您稍微看過有個概念即可</p><h4 id=設定教學>設定教學</h4><h5 id=part-1-準備-rc-檔案>Part 1: 準備 rc 檔案</h5><p>複製以下的內容再稍微修改即可</p><p><strong>resource.rc</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#960050;background-color:#1e0010>VS_VERSION_INFO</span> <span style=color:#960050;background-color:#1e0010>VERSIONINFO</span>
    <span style=color:#960050;background-color:#1e0010>FILEVERSION</span>    <span style=color:#ae81ff>0</span><span style=color:#960050;background-color:#1e0010>,</span><span style=color:#ae81ff>0</span><span style=color:#960050;background-color:#1e0010>,</span><span style=color:#ae81ff>0</span><span style=color:#960050;background-color:#1e0010>,</span><span style=color:#ae81ff>0</span>
    <span style=color:#960050;background-color:#1e0010>PRODUCTVERSION</span> <span style=color:#ae81ff>0</span><span style=color:#960050;background-color:#1e0010>,</span><span style=color:#ae81ff>0</span><span style=color:#960050;background-color:#1e0010>,</span><span style=color:#ae81ff>0</span><span style=color:#960050;background-color:#1e0010>,</span><span style=color:#ae81ff>0</span>
{
    <span style=color:#960050;background-color:#1e0010>BLOCK</span> <span style=color:#f92672>&#34;StringFileInfo&#34;</span>
    {
        <span style=color:#960050;background-color:#1e0010>BLOCK</span> <span style=color:#f92672>&#34;040904b0&#34;</span>
        {
            <span style=color:#960050;background-color:#1e0010>VALUE</span> <span style=color:#f92672>&#34;CompanyName&#34;</span>,        <span style=color:#f92672>&#34;\0&#34;</span>
            <span style=color:#960050;background-color:#1e0010>VALUE</span> <span style=color:#e6db74>&#34;FileDescription&#34;</span>,    <span style=color:#f92672>&#34;\0&#34;</span>
            <span style=color:#960050;background-color:#1e0010>VALUE</span> <span style=color:#e6db74>&#34;FileVersion&#34;</span>,        <span style=color:#f92672>&#34;0.0.0.0\0&#34;</span>
            <span style=color:#960050;background-color:#1e0010>VALUE</span> <span style=color:#e6db74>&#34;LegalCopyright&#34;</span>,     <span style=color:#f92672>&#34;© 2020 Carson. All rights reserved.\0&#34;</span>
            <span style=color:#960050;background-color:#1e0010>VALUE</span> <span style=color:#e6db74>&#34;OriginalFilename&#34;</span>,   <span style=color:#f92672>&#34;.exe\0&#34;</span>
            <span style=color:#960050;background-color:#1e0010>VALUE</span> <span style=color:#e6db74>&#34;ProductName&#34;</span>,        <span style=color:#f92672>&#34;\0&#34;</span>
            <span style=color:#960050;background-color:#1e0010>VALUE</span> <span style=color:#e6db74>&#34;ProductVersion&#34;</span>,     <span style=color:#f92672>&#34;0.0.0.0\0&#34;</span>
        }
    }
    <span style=color:#960050;background-color:#1e0010>BLOCK</span> <span style=color:#e6db74>&#34;VarFileInfo&#34;</span>
    {
        <span style=color:#960050;background-color:#1e0010>VALUE</span> <span style=color:#f92672>&#34;Translation&#34;</span>, <span style=color:#960050;background-color:#1e0010>0x0404,</span> <span style=color:#960050;background-color:#1e0010>1200</span>
    }
}
</code></pre></div><h5 id=part-2-compile-res-into-rc-files>Part 2: Compile res into rc files</h5><p>batch檔案使用<code>^</code>可以換行</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bat data-lang=bat>ResourceHacker.exe -open resources.rc -save resources.res <span style=color:#ae81ff>^
</span><span style=color:#ae81ff> </span>-action compile -log CONSOLE
</code></pre></div><h5 id=part-3-download-resourcehacker>Part 3: Download ResourceHacker</h5><blockquote><p>choco install reshack -y</p></blockquote><p>詳請參考: <a href=https://carsonslovoka.github.io/os/windows/package_manager/#一些常用的安裝項目>套件安裝-常用安裝項目-reshack</a></p><p>如果您要直接上官網下載也是可以</p><blockquote><p><a href=http://www.angusj.com/resourcehacker/>ResourceHacker</a></p></blockquote><p>只是我比較喜歡用套件管理工具，方便我知道我總共裝了什麼，要移植到新的電腦也方便</p><h5 id=part-3-執行batch檔案>Part 3: 執行Batch檔案</h5><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bat data-lang=bat>ResourceHacker.exe -open %OUTPUT_EXE% -save %OUTPUT_EXE% <span style=color:#ae81ff>^
</span><span style=color:#ae81ff> </span>-resource resources.res <span style=color:#ae81ff>^
</span><span style=color:#ae81ff> </span>-action addoverwrite <span style=color:#ae81ff>^
</span><span style=color:#ae81ff> </span>-mask VersionInf <span style=color:#ae81ff>^
</span><span style=color:#ae81ff> </span>-log CONSOLE
</code></pre></div><p>如果您對於ResourceHacker的指令感到困惑，請務必參考:<a href=http://www.angusj.com/resourcehacker>Command Line Syntax</a> (點進去搜尋<strong>Command Line Syntax</strong>就會看到，真的寫得很詳細)</p><h3 id=總結script>總結Script</h3><p>使用以下的腳本稍微做一點更改就可以幫您完成三個項目</p><ol><li>打包go</li><li>為執行檔加上icon</li><li>加上詳細資料</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bat data-lang=bat>@<span style=color:#66d9ef>echo</span> off
<span style=color:#66d9ef>SET</span> OUTPUT_EXE=xxx.exe
<span style=color:#66d9ef>cd</span> ..
<span style=color:#66d9ef>SET</span> outputDir=%cd%     &lt;-- 也就是您的package main go的檔案資料夾
<span style=color:#66d9ef>cd</span> %~dp0

<span style=color:#66d9ef>echo</span>. ==============
<span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;manifest&#34;</span> to <span style=color:#e6db74>&#34;syso&#34;</span>
rsrc.exe -manifest app.manifest -o app.syso -ico app.ico

<span style=color:#66d9ef>echo</span>. ==============
<span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;resource.rc&#34;</span> to <span style=color:#e6db74>&#34;resource.res&#34;</span>
ResourceHacker.exe -open resources.rc -save resources.res -action compile -log CONSOLE
<span style=color:#66d9ef>move</span> resources.res %outputDir%

<span style=color:#66d9ef>echo</span>. ==============
<span style=color:#66d9ef>echo</span> move <span style=color:#e6db74>&#34;syso&#34;</span> to main.go dir
<span style=color:#66d9ef>move</span> app.syso %outputDir%


<span style=color:#66d9ef>echo</span>. ==============
<span style=color:#66d9ef>echo</span> go build
<span style=color:#66d9ef>cd</span> %outputDir%
go build -o %OUTPUT_EXE%

<span style=color:#66d9ef>echo</span>. ==============
<span style=color:#66d9ef>echo</span> VersionInf
<span style=color:#75715e>REM http://www.angusj.com/resourcehacker/</span>
ResourceHacker.exe -open %OUTPUT_EXE% -save %OUTPUT_EXE% -resource resources.res -action addoverwrite -mask VersionInf -log CONSOLE

<span style=color:#66d9ef>cd</span> %~dp0
<span style=color:#66d9ef>echo</span> ==============
<span style=color:#66d9ef>echo</span> done! &amp;&amp; <span style=color:#66d9ef>pause</span> &gt; nul
</code></pre></div><h3 id=faq>FAQ</h3><h4 id=rsrcexe-不是內部或外部命令可執行的程式或批次檔>rsrc.exe' 不是內部或外部命令、可執行的程式或批次檔。</h4><p>請確認您的系統變數可以搜的到這個檔案，</p><p>如果可以，請確認您的環境變數的設定</p><p>如果rsrc.exe是能在「系統變數」找到</p><p>那麼您只能以「系統管理員身份」來執行程式才可以知道這個執行檔的位置</p><p>一般的執行只會以「當前的使用者」去查看「使用者變數」，所以如果使用者變數沒有設定，就會導致它不知道這個執行檔的位子。</p><p>❗ 如果系統管理員身分來執行，則當前的工作目錄是<code>C:WINDOWS\System2\cmd.exe</code>，所以您可以考慮在一開始的時候就<code>cd %~dp0</code>先切換到腳本的目錄</p><h2 id=linking-stage>linking stage</h2><blockquote><p><code>go build -ldflags "..."</code></p></blockquote><p>這連結階段，我們有辦法去對程式的變數再進行修改</p><p>例如</p><div class="as_fixed_table-container set_highlight-pre_mh40"><div class=as_table-container-col><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bat data-lang=bat><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>@<span style=color:#66d9ef>echo</span> off
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#66d9ef>SET</span> VERSION=0.0.0
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span style=color:#66d9ef>SET</span> NAME=TEST
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span style=color:#75715e>REM -ldflags &#34;-X packageName.var1=&#39;value1&#39; -X pack2.var2=&#39;val2&#39;&#34;``</span>
<span style=display:block;width:100%;background-color:#3c3d38><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span>go build -ldflags <span style=color:#e6db74>&#34;-X main.__VERSION__=&#39;</span>%VERSION%<span style=color:#e6db74>&#39; -X main.__NAME__=&#39;</span>%NAME%<span style=color:#e6db74>&#39;&#34;</span>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span style=color:#66d9ef>pause</span> &gt; nul
</code></pre></div><p>透過:</p><blockquote><p><code>-ldflags "-X packageName.variable='val'</code></p></blockquote><p>語句可以去修改變數的數值，如果有多個數值也只要放置多個<code>-X</code>即可</p></div><div class=as_table-container-col><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span style=color:#f92672>import</span> (
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span>    <span style=color:#e6db74>&#34;fmt&#34;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span style=color:#66d9ef>var</span> (
<span style=display:block;width:100%;background-color:#3c3d38><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span>    <span style=color:#a6e22e>__VERSION__</span> = <span style=color:#e6db74>&#34;在編譯時決定&#34;</span>
</span><span style=display:block;width:100%;background-color:#3c3d38><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span>    <span style=color:#a6e22e>__NAME__</span> = <span style=color:#e6db74>&#34;&#34;</span>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span>    <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;ProgName:%s\n&#34;</span>, <span style=color:#a6e22e>__NAME__</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span>    <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;Version:%s\n&#34;</span>, <span style=color:#a6e22e>__VERSION__</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span>}
</code></pre></div></div></div><p>這樣做可以不需要在程式指定變數的數值，可以由外部的檔案來決定，</p><p>但其實放程式中也是還好，通常程式都有一個單獨寫一堆變數的檔案，</p><p>有一種情形使用這種方法可能有用，那就是其實程式沒有更動，只有修改外部的資源檔案</p><p>那打包的人員不用在開程式，只要改一下外部的定義，重新編譯即可。</p><p>但我還是覺得沒太大的幫助😆</p><h2 id=參考資料>參考資料</h2><ul><li><a href=https://github.com/josephspurrier/goversioninfo>GoVersionInfo</a></li><li><a href=http://www.angusj.com/resourcehacker/>Resource Hacker</a></li><li><a href=https://stackoverflow.com/questions/284258/how-do-i-set-the-version-information-for-an-existing-exe-dll>how-do-i-set-the-version-information-for-an-existing-exe-dll</a></li></ul><div class=mt3><hr></div><div class=mt4><ul class=pa0><li class=list><a href=/tags/exe class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">exe</a></li><li class=list><a href=/tags/go class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">go</a></li></ul></div><div class="mt6 instapaper_ignoref"><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//carson-blog.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div><aside class="w-30-l mt6-l navbar-right large-screen-only"><nav id=TableOfContents><ul><li><a href=#ldflags>ldflags</a><ul><li><a href=#不顯示console視窗的方法>不顯示console視窗的方法</a></li><li><a href=#更小的執行檔>更小的執行檔</a></li></ul></li><li><a href=#如何為您的程式加上詳細內容>如何為您的程式加上詳細內容</a><ul><li><a href=#manifest><a href=https://docs.microsoft.com/en-us/windows/win32/sbscs/application-manifests>manifest</a></a><ul><li><a href=#part-1-建立manifest檔案>Part 1: 建立manifest檔案</a></li><li><a href=#part-2-安裝rsrc>Part 2: 安裝rsrc</a></li><li><a href=#part-3-準備icon-可選>Part 3: 準備icon (可選)</a></li><li><a href=#part-4-利用-rsrcexe-產生-syso檔案>Part 4: 利用 rsrc.exe 產生 syso檔案</a></li><li><a href=#part-5-go-build>Part 5: go build</a></li></ul></li><li><a href=#versioninfo><a href=https://docs.microsoft.com/en-us/windows/win32/menurc/versioninfo-resource>VersionInfo</a></a><ul><li><a href=#簡介>簡介</a></li><li><a href=#設定教學>設定教學</a><ul><li><a href=#part-1-準備-rc-檔案>Part 1: 準備 rc 檔案</a></li><li><a href=#part-2-compile-res-into-rc-files>Part 2: Compile res into rc files</a></li><li><a href=#part-3-download-resourcehacker>Part 3: Download ResourceHacker</a></li><li><a href=#part-3-執行batch檔案>Part 3: 執行Batch檔案</a></li></ul></li></ul></li><li><a href=#總結script>總結Script</a></li><li><a href=#faq>FAQ</a><ul><li><a href=#rsrcexe-不是內部或外部命令可執行的程式或批次檔>rsrc.exe' 不是內部或外部命令、可執行的程式或批次檔。</a></li></ul></li></ul></li><li><a href=#linking-stage>linking stage</a></li><li><a href=#參考資料>參考資料</a></li></ul></nav><script defer src=/js/uml/toc_markmap.js></script><div id=toc><div id=navbar class="pa3 nested-list-reset nested-copy-line-height nested-links"><a class="navbar-brand ms-2" href=# style=color:#212529>Go Build</a><nav class="navbar navbar-light"><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><a class="nav-link ms-0" href=#ldflags>ldflags</a></nav></nav><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><a class="nav-link ms-2" href=#不顯示console視窗的方法>不顯示console視窗的方法</a></nav></nav></nav><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><a class="nav-link ms-2" href=#更小的執行檔>更小的執行檔</a></nav></nav></nav><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><a class="nav-link ms-0" href=#如何為您的程式加上詳細內容>如何為您的程式加上詳細內容</a></nav></nav><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><a class="nav-link ms-2" href=#manifest>manifest</a></nav></nav></nav><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><a class="nav-link ms-4" href=#part-1-建立manifest檔案>Part 1: 建立manifest檔案</a></nav></nav></nav></nav><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><a class="nav-link ms-4" href=#part-2-安裝rsrc>Part 2: 安裝rsrc</a></nav></nav></nav></nav><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><a class="nav-link ms-4" href=#part-3-準備icon-可選>Part 3: 準備icon (可選)</a></nav></nav></nav></nav><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><a class="nav-link ms-4" href=#part-4-利用-rsrcexe-產生-syso檔案>Part 4: 利用 rsrc.exe 產生 syso檔案</a></nav></nav></nav></nav><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><a class="nav-link ms-4" href=#part-5-go-build>Part 5: go build</a></nav></nav></nav></nav><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><a class="nav-link ms-2" href=#versioninfo>VersionInfo</a></nav></nav></nav><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><a class="nav-link ms-4" href=#簡介>簡介</a></nav></nav></nav></nav><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><a class="nav-link ms-4" href=#設定教學>設定教學</a></nav></nav></nav></nav><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><a class="nav-link ms-2" href=#總結script>總結Script</a></nav></nav></nav><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><a class="nav-link ms-2" href=#faq>FAQ</a></nav></nav></nav><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><a class="nav-link ms-4" href=#rsrcexe-不是內部或外部命令可執行的程式或批次檔>rsrc.exe' 不是內部或外部命令、可執行的程式或批次檔。</a></nav></nav></nav></nav><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><a class="nav-link ms-0" href=#linking-stage>linking stage</a></nav></nav><nav class="nav nav-pills flex-column"><nav class="nav nav-pills flex-column"><a class="nav-link ms-0" href=#參考資料>參考資料</a></nav></nav></nav></nav></div><div class="pa3 nested-list-reset nested-copy-line-height nested-links"><p class="f5 b mb3 ms-2">相關內容</p><ul class="pa0 list"><li class="mb2 ms-2"><a href=/ide/jetbrains/golang/go-settings/>Golang Settings</a></li><li class="mb2 ms-2"><a href=/pg_lang/golang/go-tutorial/>golang基礎教學</a></li></ul></div></div></aside></article></main><div id=fastSearch><input id=searchInput tabindex=0><ul id=searchResults></ul></div><script src=/js/search/fuse/fuse.js></script><script src=/js/search/fuse/fastsearch.js></script><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://carsonslovoka.github.io/>&copy; Carson 2020-2022</a><div></div></div></footer><script src=/dist/js/app.3fc0f988d21662902933.js></script><script src=/dist/js/utils.js></script><script src=/js/clipboard/copy-code-block.js></script></body></html>